{% extends 'base-staff.html.twig' %}

{% block title %}{{ produit.nom }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .produit-details {
            display: flex;
            gap: 3rem;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }

        .produit-images {
            flex: 1;
            min-width: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 2rem;
        }

        .produit-images img {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
            border-radius: 4px;
        }

        .produit-info {
            flex: 1;
            padding: 1rem;
        }

        .produit-info h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: #333;
        }

        .price {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 1.5rem;
        }

        .category {
            color: #666;
            margin-bottom: 1rem;
        }

        .eco-friendly {
            color: #28a745;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .description {
            line-height: 1.6;
            margin-bottom: 2rem;
            color: #444;
        }

        .stock-info {
            margin-bottom: 2rem;
        }

        .in-stock {
            color: #28a745;
            font-weight: 500;
        }

        .out-of-stock {
            color: #dc3545;
            font-weight: 500;
        }

        .quantity-selector {
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quantity-selector input {
            width: 80px;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .btn-primary {
            background-color: #2c3e50;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            transition: background-color 0.3s;
        }

        .btn-primary:hover {
            background-color: #1a252f;
        }

        .cart-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .btn-view-cart {
            background-color: #6c757d;
            border: none;
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            transition: background-color 0.3s;
            color: white;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .btn-view-cart:hover {
            background-color: #5a6268;
            color: white;
        }

        @media (max-width: 768px) {
            .produit-details {
                flex-direction: column;
                padding: 1rem;
            }
            
            .produit-images {
                min-width: auto;
                padding: 1rem;
            }

            .cart-actions {
                flex-direction: column;
            }
        }
    </style>
{% endblock %}

{% block body %}
    <div class="produit-details">
        <div class="produit-images">
            {% if produit.image %}
                <img src="{{ path('produit_image', {'id': produit.id}) }}" 
                     alt="{{ produit.nom }}"
                     onerror="this.onerror=null;this.src='{{ asset('images/default-product.png') }}'">
            {% else %}
                <img src="{{ asset('images/default-product.png') }}" alt="Produit par d√©faut">
            {% endif %}
        </div>
        
        <div class="produit-info">
            <h1>{{ produit.nom }}</h1>
            <p class="price">{{ produit.prixUnitaire|number_format(2, ',', ' ') }} ‚Ç¨</p>
            <p class="category">Cat√©gorie: {{ produit.categorie ?? 'Non sp√©cifi√©e' }}</p>
            
            {% if produit.ecoFriendly %}
                <p class="eco-friendly">üå± Produit √©co-responsable</p>
            {% endif %}
            
            <p class="description">{{ produit.description ?? 'Aucune description disponible' }}</p>
            
            <div class="stock-info">
                {% if produit.quantiteStock > 0 %}
                    <p class="in-stock">En stock ({{ produit.quantiteStock }} disponible(s))</p>
                {% else %}
                    <p class="out-of-stock">Rupture de stock</p>
                {% endif %}
            </div>
            
            {% if produit.quantiteStock > 0 %}
                <div class="cart-actions">
                    <form action="{{ path('ajouter_article', {produitId: produit.id}) }}" method="post" class="flex-grow-1">
                        <div class="quantity-selector">
                            <label for="quantite">Quantit√©:</label>
                            <input type="number" 
                                   id="quantite" 
                                   name="quantite" 
                                   value="1" 
                                   min="1" 
                                   max="{{ produit.quantiteStock }}"
                                   required>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-cart-plus me-2"></i>Ajouter au panier
                        </button>
                        <input type="hidden" name="_token" value="{{ csrf_token('add_to_cart_' ~ produit.id) }}">
                    </form>
                    
                    <a href="{{ path('panier') }}" class="btn-view-cart">
                        <i class="fas fa-shopping-cart me-2"></i>Voir le panier
                    </a>
                </div>
            {% else %}
                <a href="{{ path('panier') }}" class="btn-view-cart">
                    <i class="fas fa-shopping-cart me-2"></i>Voir le panier
                </a>
            {% endif %}
            
            {% if is_granted('ROLE_ADMIN') %}
                <div class="admin-actions mt-4">
                    <a href="{{ path('edit_produit', {id: produit.id}) }}" class="btn btn-sm btn-outline-secondary me-2">
                        <i class="fas fa-edit me-1"></i>Modifier
                    </a>
                    <form method="post" action="{{ path('delete_produit', {id: produit.id}) }}" class="d-inline" onsubmit="return confirm('√ätes-vous s√ªr de vouloir supprimer ce produit?');">
                        <input type="hidden" name="_token" value="{{ csrf_token('delete_' ~ produit.id) }}">
                        <button type="submit" class="btn btn-sm btn-outline-danger">
                            <i class="fas fa-trash me-1"></i>Supprimer
                        </button>
                    </form>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}